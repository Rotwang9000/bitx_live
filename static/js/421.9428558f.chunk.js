"use strict";(globalThis.webpackChunkwinbit32=globalThis.webpackChunkwinbit32||[]).push([[421],{86421:(t,e,s)=>{s.d(e,{BrowserProvider:()=>Yt});var r=s(10046),n=s(41322),i=s(37420),a=s(59799),o=s(81577),l=s(55860),c=s(78804),u=s(33206),h=s(6045),d=s(90);function p(t){return async function(t,e){(0,r.vA)(null==e||!e.cancelled,"request cancelled before sending","CANCELLED");const s=t.url.split(":")[0].toLowerCase();(0,r.vA)("http"===s||"https"===s,`unsupported protocol ${s}`,"UNSUPPORTED_OPERATION",{info:{protocol:s},operation:"request"}),(0,r.vA)("https"===s||!t.credentials||t.allowInsecureAuthentication,"insecure authorized connections unsupported","UNSUPPORTED_OPERATION",{operation:"request"});let n=null;const i=new AbortController,a=setTimeout((()=>{n=(0,r.xz)("request timeout","TIMEOUT"),i.abort()}),t.timeout);e&&e.addListener((()=>{n=(0,r.xz)("request cancelled","CANCELLED"),i.abort()}));const o={method:t.method,headers:new Headers(Array.from(t)),body:t.body||void 0,signal:i.signal};let l;try{l=await fetch(t.url,o)}catch(d){if(clearTimeout(a),n)throw n;throw d}clearTimeout(a);const c={};l.headers.forEach(((t,e)=>{c[e.toLowerCase()]=t}));const u=await l.arrayBuffer(),h=null==u?null:new Uint8Array(u);return{statusCode:l.status,statusMessage:l.statusText,headers:c,body:h}}}p();let g=p();const f=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),m=new RegExp("^ipfs://(ipfs/)?(.*)$","i");let w=!1;async function y(t,e){try{const e=t.match(f);if(!e)throw new Error("invalid data");return new R(200,"OK",{"content-type":e[1]||"text/plain"},e[2]?function(t){t=atob(t);const e=new Uint8Array(t.length);for(let s=0;s<t.length;s++)e[s]=t.charCodeAt(s);return(0,h.q5)(e)}(e[3]):(s=e[3],(0,u.YW)(s.replace(/%([0-9a-f][0-9a-f])/gi,((t,e)=>String.fromCharCode(parseInt(e,16)))))))}catch(r){return new R(599,"BAD REQUEST (invalid data: URI)",{},null,new A(t))}var s}function b(t){return async function(e,s){try{const s=e.match(m);if(!s)throw new Error("invalid link");return new A(`${t}${s[2]}`)}catch(r){return new R(599,"BAD REQUEST (invalid IPFS URI)",{},null,new A(e))}}}const v={data:y,ipfs:b("https://gateway.ipfs.io/ipfs/")},k=new WeakMap;class T{#t;#e;constructor(t){this.#t=[],this.#e=!1,k.set(t,(()=>{if(!this.#e){this.#e=!0;for(const t of this.#t)setTimeout((()=>{t()}),0);this.#t=[]}}))}addListener(t){(0,r.vA)(!this.#e,"singal already cancelled","UNSUPPORTED_OPERATION",{operation:"fetchCancelSignal.addCancelListener"}),this.#t.push(t)}get cancelled(){return this.#e}checkSignal(){(0,r.vA)(!this.cancelled,"cancelled","CANCELLED",{})}}function N(t){if(null==t)throw new Error("missing signal; should not happen");return t.checkSignal(),t}class A{#s;#r;#n;#i;#a;#o;#l;#c;#u;#h;#d;#p;#g;#f;#m;get url(){return this.#o}set url(t){this.#o=String(t)}get body(){return null==this.#l?null:new Uint8Array(this.#l)}set body(t){if(null==t)this.#l=void 0,this.#c=void 0;else if("string"===typeof t)this.#l=(0,u.YW)(t),this.#c="text/plain";else if(t instanceof Uint8Array)this.#l=t,this.#c="application/octet-stream";else{if("object"!==typeof t)throw new Error("invalid body");this.#l=(0,u.YW)(JSON.stringify(t)),this.#c="application/json"}}hasBody(){return null!=this.#l}get method(){return this.#i?this.#i:this.hasBody()?"POST":"GET"}set method(t){null==t&&(t=""),this.#i=String(t).toUpperCase()}get headers(){const t=Object.assign({},this.#n);return this.#u&&(t.authorization=`Basic ${function(t){const e=(0,h.q5)(t);let s="";for(let r=0;r<e.length;r++)s+=String.fromCharCode(e[r]);return btoa(s)}((0,u.YW)(this.#u))}`),this.allowGzip&&(t["accept-encoding"]="gzip"),null==t["content-type"]&&this.#c&&(t["content-type"]=this.#c),this.body&&(t["content-length"]=String(this.body.length)),t}getHeader(t){return this.headers[t.toLowerCase()]}setHeader(t,e){this.#n[String(t).toLowerCase()]=String(e)}clearHeaders(){this.#n={}}[Symbol.iterator](){const t=this.headers,e=Object.keys(t);let s=0;return{next:()=>{if(s<e.length){const r=e[s++];return{value:[r,t[r]],done:!1}}return{value:void 0,done:!0}}}}get credentials(){return this.#u||null}setCredentials(t,e){(0,r.MR)(!t.match(/:/),"invalid basic authentication username","username","[REDACTED]"),this.#u=`${t}:${e}`}get allowGzip(){return this.#r}set allowGzip(t){this.#r=!!t}get allowInsecureAuthentication(){return!!this.#s}set allowInsecureAuthentication(t){this.#s=!!t}get timeout(){return this.#a}set timeout(t){(0,r.MR)(t>=0,"timeout must be non-zero","timeout",t),this.#a=t}get preflightFunc(){return this.#h||null}set preflightFunc(t){this.#h=t}get processFunc(){return this.#d||null}set processFunc(t){this.#d=t}get retryFunc(){return this.#p||null}set retryFunc(t){this.#p=t}get getUrlFunc(){return this.#m||g}set getUrlFunc(t){this.#m=t}constructor(t){this.#o=String(t),this.#s=!1,this.#r=!0,this.#n={},this.#i="",this.#a=3e5,this.#f={slotInterval:250,maxAttempts:12},this.#m=null}toString(){return`<FetchRequest method=${JSON.stringify(this.method)} url=${JSON.stringify(this.url)} headers=${JSON.stringify(this.headers)} body=${this.#l?(0,h.c$)(this.#l):"null"}>`}setThrottleParams(t){null!=t.slotInterval&&(this.#f.slotInterval=t.slotInterval),null!=t.maxAttempts&&(this.#f.maxAttempts=t.maxAttempts)}async#w(t,e,s,n,i){if(t>=this.#f.maxAttempts)return i.makeServerError("exceeded maximum retry limit");(0,r.vA)(E()<=e,"timeout","TIMEOUT",{operation:"request.send",reason:"timeout",request:n}),s>0&&await function(t){return new Promise((e=>setTimeout(e,t)))}(s);let a=this.clone();const o=(a.url.split(":")[0]||"").toLowerCase();if(o in v){const t=await v[o](a.url,N(n.#g));if(t instanceof R){let e=t;if(this.processFunc){N(n.#g);try{e=await this.processFunc(a,e)}catch(u){null!=u.throttle&&"number"===typeof u.stall||e.makeServerError("error in post-processing function",u).assertOk()}}return e}a=t}this.preflightFunc&&(a=await this.preflightFunc(a));const l=await this.getUrlFunc(a,N(n.#g));let c=new R(l.statusCode,l.statusMessage,l.headers,l.body,n);if(301===c.statusCode||302===c.statusCode){try{const s=c.headers.location||"";return a.redirect(s).#w(t+1,e,0,n,c)}catch(u){}return c}if(429===c.statusCode&&(null==this.retryFunc||await this.retryFunc(a,c,t))){const s=c.headers["retry-after"];let r=this.#f.slotInterval*Math.trunc(Math.random()*Math.pow(2,t));return"string"===typeof s&&s.match(/^[1-9][0-9]*$/)&&(r=parseInt(s)),a.clone().#w(t+1,e,r,n,c)}if(this.processFunc){N(n.#g);try{c=await this.processFunc(a,c)}catch(u){null!=u.throttle&&"number"===typeof u.stall||c.makeServerError("error in post-processing function",u).assertOk();let s=this.#f.slotInterval*Math.trunc(Math.random()*Math.pow(2,t));return u.stall>=0&&(s=u.stall),a.clone().#w(t+1,e,s,n,c)}}return c}send(){return(0,r.vA)(null==this.#g,"request already sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.send"}),this.#g=new T(this),this.#w(0,E()+this.timeout,0,this,new R(0,"",{},null,this))}cancel(){(0,r.vA)(null!=this.#g,"request has not been sent","UNSUPPORTED_OPERATION",{operation:"fetchRequest.cancel"});const t=k.get(this);if(!t)throw new Error("missing signal; should not happen");t()}redirect(t){const e=this.url.split(":")[0].toLowerCase(),s=t.split(":")[0].toLowerCase();(0,r.vA)("GET"===this.method&&("https"!==e||"http"!==s)&&t.match(/^https?:/),"unsupported redirect","UNSUPPORTED_OPERATION",{operation:`redirect(${this.method} ${JSON.stringify(this.url)} => ${JSON.stringify(t)})`});const n=new A(t);return n.method="GET",n.allowGzip=this.allowGzip,n.timeout=this.timeout,n.#n=Object.assign({},this.#n),this.#l&&(n.#l=new Uint8Array(this.#l)),n.#c=this.#c,n}clone(){const t=new A(this.url);return t.#i=this.#i,this.#l&&(t.#l=this.#l),t.#c=this.#c,t.#n=Object.assign({},this.#n),t.#u=this.#u,this.allowGzip&&(t.allowGzip=!0),t.timeout=this.timeout,this.allowInsecureAuthentication&&(t.allowInsecureAuthentication=!0),t.#h=this.#h,t.#d=this.#d,t.#p=this.#p,t.#f=Object.assign({},this.#f),t.#m=this.#m,t}static lockConfig(){w=!0}static getGateway(t){return v[t.toLowerCase()]||null}static registerGateway(t,e){if("http"===(t=t.toLowerCase())||"https"===t)throw new Error(`cannot intercept ${t}; use registerGetUrl`);if(w)throw new Error("gateways locked");v[t]=e}static registerGetUrl(t){if(w)throw new Error("gateways locked");g=t}static createGetUrlFunc(t){return p()}static createDataGateway(){return y}static createIpfsGatewayFunc(t){return b(t)}}class R{#y;#b;#n;#l;#v;#k;toString(){return`<FetchResponse status=${this.statusCode} body=${this.#l?(0,h.c$)(this.#l):"null"}>`}get statusCode(){return this.#y}get statusMessage(){return this.#b}get headers(){return Object.assign({},this.#n)}get body(){return null==this.#l?null:new Uint8Array(this.#l)}get bodyText(){try{return null==this.#l?"":(0,u._v)(this.#l)}catch(t){(0,r.vA)(!1,"response body is not valid UTF-8 data","UNSUPPORTED_OPERATION",{operation:"bodyText",info:{response:this}})}}get bodyJson(){try{return JSON.parse(this.bodyText)}catch(t){(0,r.vA)(!1,"response body is not valid JSON","UNSUPPORTED_OPERATION",{operation:"bodyJson",info:{response:this}})}}[Symbol.iterator](){const t=this.headers,e=Object.keys(t);let s=0;return{next:()=>{if(s<e.length){const r=e[s++];return{value:[r,t[r]],done:!1}}return{value:void 0,done:!0}}}}constructor(t,e,s,r,n){this.#y=t,this.#b=e,this.#n=Object.keys(s).reduce(((t,e)=>(t[e.toLowerCase()]=String(s[e]),t)),{}),this.#l=null==r?null:new Uint8Array(r),this.#v=n||null,this.#k={message:""}}makeServerError(t,e){let s;s=t?`CLIENT ESCALATED SERVER ERROR (${this.statusCode} ${this.statusMessage}; ${t})`:`CLIENT ESCALATED SERVER ERROR (${t=`${this.statusCode} ${this.statusMessage}`})`;const r=new R(599,s,this.headers,this.body,this.#v||void 0);return r.#k={message:t,error:e},r}throwThrottleError(t,e){null==e?e=-1:(0,r.MR)(Number.isInteger(e)&&e>=0,"invalid stall timeout","stall",e);const s=new Error(t||"throttling requests");throw(0,c.n)(s,{stall:e,throttle:!0}),s}getHeader(t){return this.headers[t.toLowerCase()]}hasBody(){return null!=this.#l}get request(){return this.#v}ok(){return""===this.#k.message&&this.statusCode>=200&&this.statusCode<300}assertOk(){if(this.ok())return;let{message:t,error:e}=this.#k;""===t&&(t=`server response ${this.statusCode} ${this.statusMessage}`);let s=null;this.request&&(s=this.request.url);let n=null;try{this.#l&&(n=(0,u._v)(this.#l))}catch(i){}(0,r.vA)(!1,t,"SERVER_ERROR",{request:this.request||"unknown request",response:this,error:e,info:{requestUrl:s,responseBody:n,responseStatus:`${this.statusCode} ${this.statusMessage}`}})}}function E(){return(new Date).getTime()}var _=s(93237),O=s(12235),P=s(23510),C=s(79205);const I=new Uint8Array(32);function x(t){return(0,r.MR)(0!==t.length,"invalid ENS name; empty component","comp",t),t}function S(t){const e=(0,u.YW)(function(t){try{if(0===t.length)throw new Error("empty label");return(0,C.tt)(t)}catch(e){(0,r.MR)(!1,`invalid ENS name (${e.message})`,"name",t)}}(t)),s=[];if(0===t.length)return s;let n=0;for(let r=0;r<e.length;r++){46===e[r]&&(s.push(x(e.slice(n,r))),n=r+1)}return(0,r.MR)(n<e.length,"invalid ENS name; empty component","name",t),s.push(x(e.slice(n))),s}function L(t){(0,r.MR)("string"===typeof t,"invalid ENS name; not a string","name",t),(0,r.MR)(t.length,"invalid ENS name (empty label)","name",t);let e=I;const s=S(t);for(;s.length;)e=(0,P.S)((0,h.xW)([e,(0,P.S)(s.pop())]));return(0,h.c$)(e)}function F(t,e){const s=null!=e?e:63;return(0,r.MR)(s<=255,"DNS encoded label cannot exceed 255","length",s),(0,h.c$)((0,h.xW)(S(t).map((e=>{(0,r.MR)(e.length<=s,`label ${JSON.stringify(t)} exceeds ${s} bytes`,"name",t);const n=new Uint8Array(e.length+1);return n.set(e,1),n[0]=n.length-1,n}))))+"00"}I.fill(0);var U=s(28782),D=s(49076),B=s(73437);function G(t){return t.match(/^ipfs:\/\/ipfs\//i)?t=t.substring(12):t.match(/^ipfs:\/\//i)?t=t.substring(7):(0,r.MR)(!1,"unsupported IPFS format","link",t),`https://gateway.ipfs.io/ipfs/${t}`}class ${name;constructor(t){(0,c.n)(this,{name:t})}connect(t){return this}supportsCoinType(t){return!1}async encodeAddress(t,e){throw new Error("unsupported coin")}async decodeAddress(t,e){throw new Error("unsupported coin")}}const M=new RegExp("^(ipfs)://(.*)$","i"),q=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),M,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];class J{provider;address;name;#T;#N;constructor(t,e,s){(0,c.n)(this,{provider:t,address:e,name:s}),this.#T=null,this.#N=new O.NZ(e,["function supportsInterface(bytes4) view returns (bool)","function resolve(bytes, bytes) view returns (bytes)","function addr(bytes32) view returns (address)","function addr(bytes32, uint) view returns (bytes)","function text(bytes32, string) view returns (string)","function contenthash(bytes32) view returns (bytes)"],t)}async supportsWildcard(){return null==this.#T&&(this.#T=(async()=>{try{return await this.#N.supportsInterface("0x9061b923")}catch(t){if((0,r.bJ)(t,"CALL_EXCEPTION"))return!1;throw this.#T=null,t}})()),await this.#T}async#A(t,e){e=(e||[]).slice();const s=this.#N.interface;e.unshift(L(this.name));let n=null;await this.supportsWildcard()&&(n=s.getFunction(t),(0,r.vA)(n,"missing fragment","UNKNOWN_ERROR",{info:{funcName:t}}),e=[F(this.name,255),s.encodeFunctionData(n,e)],t="resolve(bytes,bytes)"),e.push({enableCcipRead:!0});try{const r=await this.#N[t](...e);return n?s.decodeFunctionResult(n,r)[0]:r}catch(i){if(!(0,r.bJ)(i,"CALL_EXCEPTION"))throw i}return null}async getAddress(t){if(null==t&&(t=60),60===t)try{const t=await this.#A("addr(bytes32)");return null==t||t===_.j?null:t}catch(a){if((0,r.bJ)(a,"CALL_EXCEPTION"))return null;throw a}if(t>=0&&t<2147483648){let e=t+2147483648;const s=await this.#A("addr(bytes32,uint)",[e]);if((0,h.Lo)(s,20))return(0,i.b)(s)}let e=null;for(const r of this.provider.plugins)if(r instanceof $&&r.supportsCoinType(t)){e=r;break}if(null==e)return null;const s=await this.#A("addr(bytes32,uint)",[t]);if(null==s||"0x"===s)return null;const n=await e.decodeAddress(t,s);if(null!=n)return n;(0,r.vA)(!1,"invalid coin data","UNSUPPORTED_OPERATION",{operation:`getAddress(${t})`,info:{coinType:t,data:s}})}async getText(t){const e=await this.#A("text(bytes32,string)",[t]);return null==e||"0x"===e?null:e}async getContentHash(){const t=await this.#A("contenthash(bytes32)");if(null==t||"0x"===t)return null;const e=t.match(/^0x(e3010170|e5010172)(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(e){const t="e3010170"===e[1]?"ipfs":"ipns",s=parseInt(e[4],16);if(e[5].length===2*s)return`${t}://${(0,B.R)("0x"+e[2])}`}const s=t.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(s&&64===s[1].length)return`bzz://${s[1]}`;(0,r.vA)(!1,"invalid or unsupported content hash data","UNSUPPORTED_OPERATION",{operation:"getContentHash()",info:{data:t}})}async getAvatar(){return(await this._getAvatar()).url}async _getAvatar(){const t=[{type:"name",value:this.name}];try{const s=await this.getText("avatar");if(null==s)return t.push({type:"!avatar",value:""}),{url:null,linkage:t};t.push({type:"avatar",value:s});for(let r=0;r<q.length;r++){const n=s.match(q[r]);if(null==n)continue;const i=n[1].toLowerCase();switch(i){case"https":case"data":return t.push({type:"url",value:s}),{linkage:t,url:s};case"ipfs":{const e=G(s);return t.push({type:"ipfs",value:s}),t.push({type:"url",value:e}),{linkage:t,url:e}}case"erc721":case"erc1155":{const r="erc721"===i?"tokenURI(uint256)":"uri(uint256)";t.push({type:i,value:s});const a=await this.getAddress();if(null==a)return t.push({type:"!owner",value:""}),{url:null,linkage:t};const o=(n[2]||"").split("/");if(2!==o.length)return t.push({type:`!${i}caip`,value:n[2]||""}),{url:null,linkage:t};const l=o[1],c=new O.NZ(o[0],["function tokenURI(uint) view returns (string)","function ownerOf(uint) view returns (address)","function uri(uint) view returns (string)","function balanceOf(address, uint256) view returns (uint)"],this.provider);if("erc721"===i){const e=await c.ownerOf(l);if(a!==e)return t.push({type:"!owner",value:e}),{url:null,linkage:t};t.push({type:"owner",value:e})}else if("erc1155"===i){const e=await c.balanceOf(a,l);if(!e)return t.push({type:"!balance",value:"0"}),{url:null,linkage:t};t.push({type:"balance",value:e.toString()})}let u=await c[r](l);if(null==u||"0x"===u)return t.push({type:"!metadata-url",value:""}),{url:null,linkage:t};t.push({type:"metadata-url-base",value:u}),"erc1155"===i&&(u=u.replace("{id}",(0,d.up)(l,32).substring(2)),t.push({type:"metadata-url-expanded",value:u})),u.match(/^ipfs:/i)&&(u=G(u)),t.push({type:"metadata-url",value:u});let p={};const g=await new A(u).send();g.assertOk();try{p=g.bodyJson}catch(e){try{t.push({type:"!metadata",value:g.bodyText})}catch(e){const s=g.body;return s&&t.push({type:"!metadata",value:(0,h.c$)(s)}),{url:null,linkage:t}}return{url:null,linkage:t}}if(!p)return t.push({type:"!metadata",value:""}),{url:null,linkage:t};t.push({type:"metadata",value:JSON.stringify(p)});let f=p.image;if("string"!==typeof f)return t.push({type:"!imageUrl",value:""}),{url:null,linkage:t};if(f.match(/^(https:\/\/|data:)/i));else{if(null==f.match(M))return t.push({type:"!imageUrl-ipfs",value:f}),{url:null,linkage:t};t.push({type:"imageUrl-ipfs",value:f}),f=G(f)}return t.push({type:"url",value:f}),{linkage:t,url:f}}}}}catch(e){}return{linkage:t,url:null}}static async getEnsAddress(t){const e=await t.getNetwork(),s=e.getPlugin("org.ethers.plugins.network.Ens");return(0,r.vA)(s,"network does not support ENS","UNSUPPORTED_OPERATION",{operation:"getEnsAddress",info:{network:e}}),s.address}static async#R(t,e){const s=await J.getEnsAddress(t);try{const r=new O.NZ(s,["function resolver(bytes32) view returns (address)"],t),n=await r.resolver(L(e),{enableCcipRead:!0});return n===_.j?null:n}catch(r){throw r}return null}static async fromName(t,e){let s=e;for(;;){if(""===s||"."===s)return null;if("eth"!==e&&"eth"===s)return null;const r=await J.#R(t,s);if(null!=r){const n=new J(t,r,e);return s===e||await n.supportsWildcard()?n:null}s=s.split(".").slice(1).join(".")}}}var Z=s(95418);var W=s(90760);const z=BigInt(0);function H(t,e){return function(s){return null==s?e:t(s)}}function j(t,e){return s=>{if(e&&null==s)return null;if(!Array.isArray(s))throw new Error("not an array");return s.map((e=>t(e)))}}function V(t,e){return s=>{const n={};for(const a in t){let o=a;if(e&&a in e&&!(o in s))for(const t of e[a])if(t in s){o=t;break}try{const e=t[a](s[o]);void 0!==e&&(n[a]=e)}catch(i){const t=i instanceof Error?i.message:"not-an-error";(0,r.vA)(!1,`invalid value for value.${a} (${t})`,"BAD_DATA",{value:s})}}return n}}function K(t){return(0,r.MR)((0,h.Lo)(t,!0),"invalid data","value",t),t}function Y(t){return(0,r.MR)((0,h.Lo)(t,32),"invalid hash","value",t),t}const X=V({address:i.b,blockHash:Y,blockNumber:d.WZ,data:K,index:d.WZ,removed:H((function(t){switch(t){case!0:case"true":return!0;case!1:case"false":return!1}(0,r.MR)(!1,`invalid boolean; ${JSON.stringify(t)}`,"value",t)}),!1),topics:j(Y),transactionHash:Y,transactionIndex:d.WZ},{index:["logIndex"]});const Q=V({hash:H(Y),parentHash:Y,parentBeaconBlockRoot:H(Y,null),number:d.WZ,timestamp:d.WZ,nonce:H(K),difficulty:d.Ab,gasLimit:d.Ab,gasUsed:d.Ab,stateRoot:H(Y,null),receiptsRoot:H(Y,null),blobGasUsed:H(d.Ab,null),excessBlobGas:H(d.Ab,null),miner:H(i.b),prevRandao:H(Y,null),extraData:K,baseFeePerGas:H(d.Ab)},{prevRandao:["mixHash"]});const tt=V({transactionIndex:d.WZ,blockNumber:d.WZ,transactionHash:Y,address:i.b,topics:j(Y),data:K,index:d.WZ,blockHash:Y},{index:["logIndex"]});const et=V({to:H(i.b,null),from:H(i.b,null),contractAddress:H(i.b,null),index:d.WZ,root:H(h.c$),gasUsed:d.Ab,blobGasUsed:H(d.Ab,null),logsBloom:H(K),blockHash:Y,hash:Y,logs:j((function(t){return tt(t)})),blockNumber:d.WZ,cumulativeGasUsed:d.Ab,effectiveGasPrice:H(d.Ab),blobGasPrice:H(d.Ab,null),status:H(d.WZ),type:H(d.WZ,0)},{effectiveGasPrice:["gasPrice"],hash:["transactionHash"],index:["transactionIndex"]});function st(t){t.to&&(0,d.Ab)(t.to)===z&&(t.to="0x0000000000000000000000000000000000000000");const e=V({hash:Y,index:H(d.WZ,void 0),type:t=>"0x"===t||null==t?0:(0,d.WZ)(t),accessList:H(l.$,null),blobVersionedHashes:H(j(Y,!0),null),blockHash:H(Y,null),blockNumber:H(d.WZ,null),transactionIndex:H(d.WZ,null),from:i.b,gasPrice:H(d.Ab),maxPriorityFeePerGas:H(d.Ab),maxFeePerGas:H(d.Ab),maxFeePerBlobGas:H(d.Ab,null),gasLimit:d.Ab,to:H(i.b,null),value:d.Ab,nonce:d.WZ,data:K,creates:H(i.b,null),chainId:H(d.Ab,null)},{data:["input"],gasLimit:["gas"],index:["transactionIndex"]})(t);if(null==e.to&&null==e.creates&&(e.creates=function(t){const e=(0,i.b)(t.from);let s=(0,d.Ab)(t.nonce,"tx.nonce").toString(16);return s="0"===s?"0x":s.length%2?"0x0"+s:"0x"+s,(0,i.b)((0,h.ZG)((0,P.S)((0,Z.R)([e,s])),12))}(e)),1!==t.type&&2!==t.type||null!=t.accessList||(e.accessList=[]),t.signature?e.signature=W.t.from(t.signature):e.signature=W.t.from(t),null==e.chainId){const t=e.signature.legacyChainId;null!=t&&(e.chainId=t)}return e.blockHash&&(0,d.Ab)(e.blockHash)===z&&(e.blockHash=null),e}class rt{name;constructor(t){(0,c.n)(this,{name:t})}clone(){return new rt(this.name)}}class nt extends rt{effectiveBlock;txBase;txCreate;txDataZero;txDataNonzero;txAccessListStorageKey;txAccessListAddress;constructor(t,e){null==t&&(t=0),super(`org.ethers.network.plugins.GasCost#${t||0}`);const s={effectiveBlock:t};function n(t,n){let i=(e||{})[t];null==i&&(i=n),(0,r.MR)("number"===typeof i,`invalud value for ${t}`,"costs",e),s[t]=i}n("txBase",21e3),n("txCreate",32e3),n("txDataZero",4),n("txDataNonzero",16),n("txAccessListStorageKey",1900),n("txAccessListAddress",2400),(0,c.n)(this,s)}clone(){return new nt(this.effectiveBlock,this)}}class it extends rt{address;targetNetwork;constructor(t,e){super("org.ethers.plugins.network.Ens"),(0,c.n)(this,{address:t||"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",targetNetwork:null==e?1:e})}clone(){return new it(this.address,this.targetNetwork)}}class at extends rt{#o;#E;get url(){return this.#o}get processFunc(){return this.#E}constructor(t,e){super("org.ethers.plugins.network.FetchUrlFeeDataPlugin"),this.#o=t,this.#E=e}clone(){return this}}const ot=new Map;class lt{#_;#O;#P;constructor(t,e){this.#_=t,this.#O=(0,d.Ab)(e),this.#P=new Map}toJSON(){return{name:this.name,chainId:String(this.chainId)}}get name(){return this.#_}set name(t){this.#_=t}get chainId(){return this.#O}set chainId(t){this.#O=(0,d.Ab)(t,"chainId")}matches(t){if(null==t)return!1;if("string"===typeof t){try{return this.chainId===(0,d.Ab)(t)}catch(e){}return this.name===t}if("number"===typeof t||"bigint"===typeof t){try{return this.chainId===(0,d.Ab)(t)}catch(e){}return!1}if("object"===typeof t){if(null!=t.chainId){try{return this.chainId===(0,d.Ab)(t.chainId)}catch(e){}return!1}return null!=t.name&&this.name===t.name}return!1}get plugins(){return Array.from(this.#P.values())}attachPlugin(t){if(this.#P.get(t.name))throw new Error(`cannot replace existing plugin: ${t.name} `);return this.#P.set(t.name,t.clone()),this}getPlugin(t){return this.#P.get(t)||null}getPlugins(t){return this.plugins.filter((e=>e.name.split("#")[0]===t))}clone(){const t=new lt(this.name,this.chainId);return this.plugins.forEach((e=>{t.attachPlugin(e.clone())})),t}computeIntrinsicGas(t){const e=this.getPlugin("org.ethers.plugins.network.GasCost")||new nt;let s=e.txBase;if(null==t.to&&(s+=e.txCreate),t.data)for(let r=2;r<t.data.length;r+=2)"00"===t.data.substring(r,r+2)?s+=e.txDataZero:s+=e.txDataNonzero;if(t.accessList){const r=(0,l.$)(t.accessList);for(const t in r)s+=e.txAccessListAddress+e.txAccessListStorageKey*r[t].storageKeys.length}return s}static from(t){if(function(){if(ht)return;function t(t,e,s){const r=function(){const r=new lt(t,e);return null!=s.ensNetwork&&r.attachPlugin(new it(null,s.ensNetwork)),r.attachPlugin(new nt),(s.plugins||[]).forEach((t=>{r.attachPlugin(t)})),r};lt.register(t,r),lt.register(e,r),s.altNames&&s.altNames.forEach((t=>{lt.register(t,r)}))}ht=!0,t("mainnet",1,{ensNetwork:1,altNames:["homestead"]}),t("ropsten",3,{ensNetwork:3}),t("rinkeby",4,{ensNetwork:4}),t("goerli",5,{ensNetwork:5}),t("kovan",42,{ensNetwork:42}),t("sepolia",11155111,{ensNetwork:11155111}),t("holesky",17e3,{ensNetwork:17e3}),t("classic",61,{}),t("classicKotti",6,{}),t("arbitrum",42161,{ensNetwork:1}),t("arbitrum-goerli",421613,{}),t("arbitrum-sepolia",421614,{}),t("base",8453,{ensNetwork:1}),t("base-goerli",84531,{}),t("base-sepolia",84532,{}),t("bnb",56,{ensNetwork:1}),t("bnbt",97,{}),t("linea",59144,{ensNetwork:1}),t("linea-goerli",59140,{}),t("linea-sepolia",59141,{}),t("matic",137,{ensNetwork:1,plugins:[ut("https://gasstation.polygon.technology/v2")]}),t("matic-amoy",80002,{}),t("matic-mumbai",80001,{altNames:["maticMumbai","maticmum"],plugins:[ut("https://gasstation-testnet.polygon.technology/v2")]}),t("optimism",10,{ensNetwork:1,plugins:[]}),t("optimism-goerli",420,{}),t("optimism-sepolia",11155420,{}),t("xdai",100,{ensNetwork:1})}(),null==t)return lt.from("mainnet");if("number"===typeof t&&(t=BigInt(t)),"string"===typeof t||"bigint"===typeof t){const e=ot.get(t);if(e)return e();if("bigint"===typeof t)return new lt("unknown",t);(0,r.MR)(!1,"unknown network","network",t)}if("function"===typeof t.clone){return t.clone()}if("object"===typeof t){(0,r.MR)("string"===typeof t.name&&"number"===typeof t.chainId,"invalid network object name or chainId","network",t);const e=new lt(t.name,t.chainId);return(t.ensAddress||null!=t.ensNetwork)&&e.attachPlugin(new it(t.ensAddress,t.ensNetwork)),e}(0,r.MR)(!1,"invalid network","network",t)}static register(t,e){"number"===typeof t&&(t=BigInt(t));const s=ot.get(t);s&&(0,r.MR)(!1,`conflicting network for ${JSON.stringify(s.name)}`,"nameOrChainId",t),ot.set(t,e)}}function ct(t,e){const s=String(t);if(!s.match(/^[0-9.]+$/))throw new Error(`invalid gwei value: ${t}`);const r=s.split(".");if(1===r.length&&r.push(""),2!==r.length)throw new Error(`invalid gwei value: ${t}`);for(;r[1].length<e;)r[1]+="0";if(r[1].length>9){let t=BigInt(r[1].substring(0,9));r[1].substring(9).match(/^0+$/)||t++,r[1]=t.toString()}return BigInt(r[0]+r[1])}function ut(t){return new at(t,(async(t,e,s)=>{let n;s.setHeader("User-Agent","ethers");try{const[e,r]=await Promise.all([s.send(),t()]);n=e;const i=n.bodyJson.standard;return{gasPrice:r.gasPrice,maxFeePerGas:ct(i.maxFee,9),maxPriorityFeePerGas:ct(i.maxPriorityFee,9)}}catch(i){(0,r.vA)(!1,`error encountered with polygon gas station (${JSON.stringify(s.url)})`,"SERVER_ERROR",{request:s,response:n,error:i})}}))}let ht=!1;var dt=s(24789);function pt(t){return JSON.parse(JSON.stringify(t))}class gt{#C;#I;#x;#S;constructor(t){this.#C=t,this.#I=null,this.#x=4e3,this.#S=-2}get pollingInterval(){return this.#x}set pollingInterval(t){this.#x=t}async#L(){try{const t=await this.#C.getBlockNumber();if(-2===this.#S)return void(this.#S=t);if(t!==this.#S){for(let e=this.#S+1;e<=t;e++){if(null==this.#I)return;await this.#C.emit("block",e)}this.#S=t}}catch(t){}null!=this.#I&&(this.#I=this.#C._setTimeout(this.#L.bind(this),this.#x))}start(){this.#I||(this.#I=this.#C._setTimeout(this.#L.bind(this),this.#x),this.#L())}stop(){this.#I&&(this.#C._clearTimeout(this.#I),this.#I=null)}pause(t){this.stop(),t&&(this.#S=-2)}resume(){this.start()}}class ft{#C;#L;#F;constructor(t){this.#C=t,this.#F=!1,this.#L=t=>{this._poll(t,this.#C)}}async _poll(t,e){throw new Error("sub-classes must override this")}start(){this.#F||(this.#F=!0,this.#L(-2),this.#C.on("block",this.#L))}stop(){this.#F&&(this.#F=!1,this.#C.off("block",this.#L))}pause(t){this.stop()}resume(){this.start()}}class mt extends ft{#U;#D;constructor(t,e){super(t),this.#U=e,this.#D=-2}pause(t){t&&(this.#D=-2),super.pause(t)}async _poll(t,e){const s=await e.getBlock(this.#U);null!=s&&(-2===this.#D?this.#D=s.number:s.number>this.#D&&(e.emit(this.#U,s.number),this.#D=s.number))}}class wt extends ft{#B;constructor(t,e){super(t),this.#B=pt(e)}async _poll(t,e){throw new Error("@TODO")}}class yt extends ft{#G;constructor(t,e){super(t),this.#G=e}async _poll(t,e){const s=await e.getTransactionReceipt(this.#G);s&&e.emit(this.#G,s)}}class bt{#C;#B;#I;#F;#S;constructor(t,e){this.#C=t,this.#B=pt(e),this.#I=this.#L.bind(this),this.#F=!1,this.#S=-2}async#L(t){if(-2===this.#S)return;const e=pt(this.#B);e.fromBlock=this.#S+1,e.toBlock=t;const s=await this.#C.getLogs(e);if(0!==s.length)for(const r of s)this.#C.emit(this.#B,r),this.#S=r.blockNumber;else this.#S<t-60&&(this.#S=t-60)}start(){this.#F||(this.#F=!0,-2===this.#S&&this.#C.getBlockNumber().then((t=>{this.#S=t})),this.#C.on("block",this.#I))}stop(){this.#F&&(this.#F=!1,this.#C.off("block",this.#I))}pause(t){this.stop(),t&&(this.#S=-2)}resume(){this.start()}}const vt=BigInt(2);function kt(t){return t&&"function"===typeof t.then}function Tt(t,e){return t+":"+JSON.stringify(e,((t,e)=>{if(null==e)return"null";if("bigint"===typeof e)return`bigint:${e.toString()}`;if("string"===typeof e)return e.toLowerCase();if("object"===typeof e&&!Array.isArray(e)){const t=Object.keys(e);return t.sort(),t.reduce(((t,s)=>(t[s]=e[s],t)),{})}return e}))}class Nt{name;constructor(t){(0,c.n)(this,{name:t})}start(){}stop(){}pause(t){}resume(){}}function At(t){return(t=Array.from(new Set(t).values())).sort(),t}async function Rt(t,e){if(null==t)throw new Error("invalid event");if(Array.isArray(t)&&(t={topics:t}),"string"===typeof t)switch(t){case"block":case"debug":case"error":case"finalized":case"network":case"pending":case"safe":return{type:t,tag:t}}if((0,h.Lo)(t,32)){const e=t.toLowerCase();return{type:"transaction",tag:Tt("tx",{hash:e}),hash:e}}if(t.orphan){const e=t;return{type:"orphan",tag:Tt("orphan",e),filter:(s=e,JSON.parse(JSON.stringify(s)))}}var s;if(t.address||t.topics){const s=t,r={topics:(s.topics||[]).map((t=>null==t?null:Array.isArray(t)?At(t.map((t=>t.toLowerCase()))):t.toLowerCase()))};if(s.address){const t=[],n=[],i=s=>{(0,h.Lo)(s)?t.push(s):n.push((async()=>{t.push(await(0,a.tG)(s,e))})())};Array.isArray(s.address)?s.address.forEach(i):i(s.address),n.length&&await Promise.all(n),r.address=At(t.map((t=>t.toLowerCase())))}return{filter:r,tag:Tt("event",r),type:"event"}}(0,r.MR)(!1,"unknown ProviderEvent","event",t)}function Et(){return(new Date).getTime()}const _t={cacheTimeout:250,pollingInterval:4e3};class Ot{#$;#P;#M;#q;#J;#Z;#W;#z;#H;#j;#V;#K;constructor(t,e){if(this.#K=Object.assign({},_t,e||{}),"any"===t)this.#Z=!0,this.#J=null;else if(t){const e=lt.from(t);this.#Z=!1,this.#J=Promise.resolve(e),setTimeout((()=>{this.emit("network",e,null)}),0)}else this.#Z=!1,this.#J=null;this.#z=-1,this.#W=new Map,this.#$=new Map,this.#P=new Map,this.#M=null,this.#q=!1,this.#H=1,this.#j=new Map,this.#V=!1}get pollingInterval(){return this.#K.pollingInterval}get provider(){return this}get plugins(){return Array.from(this.#P.values())}attachPlugin(t){if(this.#P.get(t.name))throw new Error(`cannot replace existing plugin: ${t.name} `);return this.#P.set(t.name,t.connect(this)),this}getPlugin(t){return this.#P.get(t)||null}get disableCcipRead(){return this.#V}set disableCcipRead(t){this.#V=!!t}async#Y(t){const e=this.#K.cacheTimeout;if(e<0)return await this._perform(t);const s=Tt(t.method,t);let r=this.#W.get(s);return r||(r=this._perform(t),this.#W.set(s,r),setTimeout((()=>{this.#W.get(s)===r&&this.#W.delete(s)}),e)),await r}async ccipReadFetch(t,e,s){if(this.disableCcipRead||0===s.length||null==t.to)return null;const n=t.to.toLowerCase(),i=e.toLowerCase(),a=[];for(let l=0;l<s.length;l++){const e=s[l],c=e.replace("{sender}",n).replace("{data}",i),u=new A(c);-1===e.indexOf("{data}")&&(u.body={data:i,sender:n}),this.emit("debug",{action:"sendCcipReadFetchRequest",request:u,index:l,urls:s});let h,d="unknown error";try{h=await u.send()}catch(o){a.push(o.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:{error:o}});continue}try{const t=h.bodyJson;if(t.data)return this.emit("debug",{action:"receiveCcipReadFetchResult",request:u,result:t}),t.data;t.message&&(d=t.message),this.emit("debug",{action:"receiveCcipReadFetchError",request:u,result:t})}catch(o){}(0,r.vA)(h.statusCode<400||h.statusCode>=500,`response not found during CCIP fetch: ${d}`,"OFFCHAIN_FAULT",{reason:"404_MISSING_RESOURCE",transaction:t,info:{url:e,errorMessage:d}}),a.push(d)}(0,r.vA)(!1,`error encountered during CCIP fetch: ${a.map((t=>JSON.stringify(t))).join(", ")}`,"OFFCHAIN_FAULT",{reason:"500_SERVER_ERROR",transaction:t,info:{urls:s,errorMessages:a}})}_wrapBlock(t,e){return new dt.eB(function(t){const e=Q(t);return e.transactions=t.transactions.map((t=>"string"===typeof t?t:st(t))),e}(t),this)}_wrapLog(t,e){return new dt.tG(function(t){return X(t)}(t),this)}_wrapTransactionReceipt(t,e){return new dt.z5(function(t){return et(t)}(t),this)}_wrapTransactionResponse(t,e){return new dt.uI(st(t),this)}_detectNetwork(){(0,r.vA)(!1,"sub-classes must implement this","UNSUPPORTED_OPERATION",{operation:"_detectNetwork"})}async _perform(t){(0,r.vA)(!1,`unsupported method: ${t.method}`,"UNSUPPORTED_OPERATION",{operation:t.method,info:t})}async getBlockNumber(){const t=(0,d.WZ)(await this.#Y({method:"getBlockNumber"}),"%response");return this.#z>=0&&(this.#z=t),t}_getAddress(t){return(0,a.tG)(t,this)}_getBlockTag(t){if(null==t)return"latest";switch(t){case"earliest":return"0x0";case"finalized":case"latest":case"pending":case"safe":return t}return(0,h.Lo)(t)?(0,h.Lo)(t,32)?t:(0,d.nD)(t):("bigint"===typeof t&&(t=(0,d.WZ)(t,"blockTag")),"number"===typeof t?t>=0?(0,d.nD)(t):this.#z>=0?(0,d.nD)(this.#z+t):this.getBlockNumber().then((e=>(0,d.nD)(e+t))):void(0,r.MR)(!1,"invalid blockTag","blockTag",t))}_getFilter(t){const e=(t.topics||[]).map((t=>null==t?null:Array.isArray(t)?At(t.map((t=>t.toLowerCase()))):t.toLowerCase())),s="blockHash"in t?t.blockHash:void 0,r=(t,r,n)=>{let i;switch(t.length){case 0:break;case 1:i=t[0];break;default:t.sort(),i=t}if(s&&(null!=r||null!=n))throw new Error("invalid filter");const a={};return i&&(a.address=i),e.length&&(a.topics=e),r&&(a.fromBlock=r),n&&(a.toBlock=n),s&&(a.blockHash=s),a};let n,i,a=[];if(t.address)if(Array.isArray(t.address))for(const o of t.address)a.push(this._getAddress(o));else a.push(this._getAddress(t.address));return"fromBlock"in t&&(n=this._getBlockTag(t.fromBlock)),"toBlock"in t&&(i=this._getBlockTag(t.toBlock)),a.filter((t=>"string"!==typeof t)).length||null!=n&&"string"!==typeof n||null!=i&&"string"!==typeof i?Promise.all([Promise.all(a),n,i]).then((t=>r(t[0],t[1],t[2]))):r(a,n,i)}_getTransactionRequest(t){const e=(0,dt.VS)(t),s=[];if(["to","from"].forEach((t=>{if(null==e[t])return;const r=(0,a.tG)(e[t],this);kt(r)?s.push(async function(){e[t]=await r}()):e[t]=r})),null!=e.blockTag){const t=this._getBlockTag(e.blockTag);kt(t)?s.push(async function(){e.blockTag=await t}()):e.blockTag=t}return s.length?async function(){return await Promise.all(s),e}():e}async getNetwork(){if(null==this.#J){const t=(async()=>{try{const t=await this._detectNetwork();return this.emit("network",t,null),t}catch(e){throw this.#J===t&&(this.#J=null),e}})();return this.#J=t,(await t).clone()}const t=this.#J,[e,s]=await Promise.all([t,this._detectNetwork()]);return e.chainId!==s.chainId&&(this.#Z?(this.emit("network",s,e),this.#J===t&&(this.#J=Promise.resolve(s))):(0,r.vA)(!1,`network changed: ${e.chainId} => ${s.chainId} `,"NETWORK_ERROR",{event:"changed"})),e.clone()}async getFeeData(){const t=await this.getNetwork(),e=async()=>{const{_block:e,gasPrice:s,priorityFee:r}=await(0,c.k)({_block:this.#X("latest",!1),gasPrice:(async()=>{try{const t=await this.#Y({method:"getGasPrice"});return(0,d.Ab)(t,"%response")}catch(t){}return null})(),priorityFee:(async()=>{try{const t=await this.#Y({method:"getPriorityFee"});return(0,d.Ab)(t,"%response")}catch(t){}return null})()});let n=null,i=null;const a=this._wrapBlock(e,t);return a&&a.baseFeePerGas&&(i=null!=r?r:BigInt("1000000000"),n=a.baseFeePerGas*vt+i),new dt.J9(s,n,i)},s=t.getPlugin("org.ethers.plugins.network.FetchUrlFeeDataPlugin");if(s){const t=new A(s.url),r=await s.processFunc(e,this,t);return new dt.J9(r.gasPrice,r.maxFeePerGas,r.maxPriorityFeePerGas)}return await e()}async estimateGas(t){let e=this._getTransactionRequest(t);return kt(e)&&(e=await e),(0,d.Ab)(await this.#Y({method:"estimateGas",transaction:e}),"%response")}async#Q(t,e,s){(0,r.vA)(s<10,"CCIP read exceeded maximum redirections","OFFCHAIN_FAULT",{reason:"TOO_MANY_REDIRECTS",transaction:Object.assign({},t,{blockTag:e,enableCcipRead:!0})});const n=(0,dt.VS)(t);try{return(0,h.c$)(await this._perform({method:"call",transaction:n,blockTag:e}))}catch(i){if(!this.disableCcipRead&&(0,r.E)(i)&&i.data&&s>=0&&"latest"===e&&null!=n.to&&"0x556f1830"===(0,h.ZG)(i.data,0,4)){const t=i.data,o=await(0,a.tG)(n.to,this);let l;try{l=function(t){const e={sender:"",urls:[],calldata:"",selector:"",extraData:"",errorArgs:[]};(0,r.vA)((0,h.pO)(t)>=160,"insufficient OffchainLookup data","OFFCHAIN_FAULT",{reason:"insufficient OffchainLookup data"});const s=(0,h.ZG)(t,0,32);(0,r.vA)((0,h.ZG)(s,0,12)===(0,h.ZG)(Ft,0,12),"corrupt OffchainLookup sender","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup sender"}),e.sender=(0,h.ZG)(s,12);try{const s=[],r=(0,d.WZ)((0,h.ZG)(t,32,64)),n=(0,d.WZ)((0,h.ZG)(t,r,r+32)),i=(0,h.ZG)(t,r+32);for(let t=0;t<n;t++){const e=Pt(i,32*t);if(null==e)throw new Error("abort");s.push(e)}e.urls=s}catch(i){(0,r.vA)(!1,"corrupt OffchainLookup urls","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup urls"})}try{const s=Ct(t,64);if(null==s)throw new Error("abort");e.calldata=s}catch(i){(0,r.vA)(!1,"corrupt OffchainLookup calldata","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup calldata"})}(0,r.vA)((0,h.ZG)(t,100,128)===(0,h.ZG)(Ft,0,28),"corrupt OffchainLookup callbaackSelector","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup callbaackSelector"}),e.selector=(0,h.ZG)(t,96,100);try{const s=Ct(t,128);if(null==s)throw new Error("abort");e.extraData=s}catch(i){(0,r.vA)(!1,"corrupt OffchainLookup extraData","OFFCHAIN_FAULT",{reason:"corrupt OffchainLookup extraData"})}return e.errorArgs="sender,urls,calldata,selector,extraData".split(/,/).map((t=>e[t])),e}((0,h.ZG)(i.data,4))}catch(i){(0,r.vA)(!1,i.message,"OFFCHAIN_FAULT",{reason:"BAD_DATA",transaction:n,info:{data:t}})}(0,r.vA)(l.sender.toLowerCase()===o.toLowerCase(),"CCIP Read sender mismatch","CALL_EXCEPTION",{action:"call",data:t,reason:"OffchainLookup",transaction:n,invocation:null,revert:{signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",name:"OffchainLookup",args:l.errorArgs}});const c=await this.ccipReadFetch(n,l.calldata,l.urls);(0,r.vA)(null!=c,"CCIP Read failed to fetch data","OFFCHAIN_FAULT",{reason:"FETCH_FAILED",transaction:n,info:{data:i.data,errorArgs:l.errorArgs}});const u={to:o,data:(0,h.xW)([l.selector,Lt([c,l.extraData])])};this.emit("debug",{action:"sendCcipReadCall",transaction:u});try{const t=await this.#Q(u,e,s+1);return this.emit("debug",{action:"receiveCcipReadCallResult",transaction:Object.assign({},u),result:t}),t}catch(i){throw this.emit("debug",{action:"receiveCcipReadCallError",transaction:Object.assign({},u),error:i}),i}}throw i}}async#tt(t){const{value:e}=await(0,c.k)({network:this.getNetwork(),value:t});return e}async call(t){const{tx:e,blockTag:s}=await(0,c.k)({tx:this._getTransactionRequest(t),blockTag:this._getBlockTag(t.blockTag)});return await this.#tt(this.#Q(e,s,t.enableCcipRead?0:-1))}async#et(t,e,s){let r=this._getAddress(e),n=this._getBlockTag(s);return"string"===typeof r&&"string"===typeof n||([r,n]=await Promise.all([r,n])),await this.#tt(this.#Y(Object.assign(t,{address:r,blockTag:n})))}async getBalance(t,e){return(0,d.Ab)(await this.#et({method:"getBalance"},t,e),"%response")}async getTransactionCount(t,e){return(0,d.WZ)(await this.#et({method:"getTransactionCount"},t,e),"%response")}async getCode(t,e){return(0,h.c$)(await this.#et({method:"getCode"},t,e))}async getStorage(t,e,s){const r=(0,d.Ab)(e,"position");return(0,h.c$)(await this.#et({method:"getStorage",position:r},t,s))}async broadcastTransaction(t){const{blockNumber:e,hash:s,network:r}=await(0,c.k)({blockNumber:this.getBlockNumber(),hash:this._perform({method:"broadcastTransaction",signedTransaction:t}),network:this.getNetwork()}),n=U.Z.from(t);if(n.hash!==s)throw new Error("@TODO: the returned hash did not match");return this._wrapTransactionResponse(n,r).replaceableTransaction(e)}async#X(t,e){if((0,h.Lo)(t,32))return await this.#Y({method:"getBlock",blockHash:t,includeTransactions:e});let s=this._getBlockTag(t);return"string"!==typeof s&&(s=await s),await this.#Y({method:"getBlock",blockTag:s,includeTransactions:e})}async getBlock(t,e){const{network:s,params:r}=await(0,c.k)({network:this.getNetwork(),params:this.#X(t,!!e)});return null==r?null:this._wrapBlock(r,s)}async getTransaction(t){const{network:e,params:s}=await(0,c.k)({network:this.getNetwork(),params:this.#Y({method:"getTransaction",hash:t})});return null==s?null:this._wrapTransactionResponse(s,e)}async getTransactionReceipt(t){const{network:e,params:s}=await(0,c.k)({network:this.getNetwork(),params:this.#Y({method:"getTransactionReceipt",hash:t})});if(null==s)return null;if(null==s.gasPrice&&null==s.effectiveGasPrice){const e=await this.#Y({method:"getTransaction",hash:t});if(null==e)throw new Error("report this; could not find tx or effectiveGasPrice");s.effectiveGasPrice=e.gasPrice}return this._wrapTransactionReceipt(s,e)}async getTransactionResult(t){const{result:e}=await(0,c.k)({network:this.getNetwork(),result:this.#Y({method:"getTransactionResult",hash:t})});return null==e?null:(0,h.c$)(e)}async getLogs(t){let e=this._getFilter(t);kt(e)&&(e=await e);const{network:s,params:r}=await(0,c.k)({network:this.getNetwork(),params:this.#Y({method:"getLogs",filter:e})});return r.map((t=>this._wrapLog(t,s)))}_getProvider(t){(0,r.vA)(!1,"provider cannot connect to target network","UNSUPPORTED_OPERATION",{operation:"_getProvider()"})}async getResolver(t){return await J.fromName(this,t)}async getAvatar(t){const e=await this.getResolver(t);return e?await e.getAvatar():null}async resolveName(t){const e=await this.getResolver(t);return e?await e.getAddress():null}async lookupAddress(t){const e=L((t=(0,i.b)(t)).substring(2).toLowerCase()+".addr.reverse");try{const s=await J.getEnsAddress(this),r=new O.NZ(s,["function resolver(bytes32) view returns (address)"],this),n=await r.resolver(e);if(null==n||n===_.j)return null;const i=new O.NZ(n,["function name(bytes32) view returns (string)"],this),a=await i.name(e);return await this.resolveName(a)!==t?null:a}catch(s){if((0,r.bJ)(s,"BAD_DATA")&&"0x"===s.value)return null;if((0,r.bJ)(s,"CALL_EXCEPTION"))return null;throw s}return null}async waitForTransaction(t,e,s){const n=null!=e?e:1;return 0===n?this.getTransactionReceipt(t):new Promise((async(e,i)=>{let a=null;const o=async s=>{try{const r=await this.getTransactionReceipt(t);if(null!=r&&s-r.blockNumber+1>=n)return e(r),void(a&&(clearTimeout(a),a=null))}catch(r){console.log("EEE",r)}this.once("block",o)};null!=s&&(a=setTimeout((()=>{null!=a&&(a=null,this.off("block",o),i((0,r.xz)("timeout","TIMEOUT",{reason:"timeout"})))}),s)),o(await this.getBlockNumber())}))}async waitForBlock(t){(0,r.vA)(!1,"not implemented yet","NOT_IMPLEMENTED",{operation:"waitForBlock"})}_clearTimeout(t){const e=this.#j.get(t);e&&(e.timer&&clearTimeout(e.timer),this.#j.delete(t))}_setTimeout(t,e){null==e&&(e=0);const s=this.#H++,r=()=>{this.#j.delete(s),t()};if(this.paused)this.#j.set(s,{timer:null,func:r,time:e});else{const t=setTimeout(r,e);this.#j.set(s,{timer:t,func:r,time:Et()})}return s}_forEachSubscriber(t){for(const e of this.#$.values())t(e.subscriber)}_getSubscriber(t){switch(t.type){case"debug":case"error":case"network":return new Nt(t.type);case"block":{const t=new gt(this);return t.pollingInterval=this.pollingInterval,t}case"safe":case"finalized":return new mt(this,t.type);case"event":return new bt(this,t.filter);case"transaction":return new yt(this,t.hash);case"orphan":return new wt(this,t.filter)}throw new Error(`unsupported event: ${t.type}`)}_recoverSubscriber(t,e){for(const s of this.#$.values())if(s.subscriber===t){s.started&&s.subscriber.stop(),s.subscriber=e,s.started&&e.start(),null!=this.#M&&e.pause(this.#M);break}}async#st(t,e){let s=await Rt(t,this);return"event"===s.type&&e&&e.length>0&&!0===e[0].removed&&(s=await Rt({orphan:"drop-log",log:e[0]},this)),this.#$.get(s.tag)||null}async#rt(t){const e=await Rt(t,this),s=e.tag;let r=this.#$.get(s);if(!r){r={subscriber:this._getSubscriber(e),tag:s,addressableMap:new WeakMap,nameMap:new Map,started:!1,listeners:[]},this.#$.set(s,r)}return r}async on(t,e){const s=await this.#rt(t);return s.listeners.push({listener:e,once:!1}),s.started||(s.subscriber.start(),s.started=!0,null!=this.#M&&s.subscriber.pause(this.#M)),this}async once(t,e){const s=await this.#rt(t);return s.listeners.push({listener:e,once:!0}),s.started||(s.subscriber.start(),s.started=!0,null!=this.#M&&s.subscriber.pause(this.#M)),this}async emit(t,...e){const s=await this.#st(t,e);if(!s||0===s.listeners.length)return!1;const r=s.listeners.length;return s.listeners=s.listeners.filter((({listener:s,once:r})=>{const n=new D.z(this,r?null:s,t);try{s.call(this,...e,n)}catch(i){}return!r})),0===s.listeners.length&&(s.started&&s.subscriber.stop(),this.#$.delete(s.tag)),r>0}async listenerCount(t){if(t){const e=await this.#st(t);return e?e.listeners.length:0}let e=0;for(const{listeners:s}of this.#$.values())e+=s.length;return e}async listeners(t){if(t){const e=await this.#st(t);return e?e.listeners.map((({listener:t})=>t)):[]}let e=[];for(const{listeners:s}of this.#$.values())e=e.concat(s.map((({listener:t})=>t)));return e}async off(t,e){const s=await this.#st(t);if(!s)return this;if(e){const t=s.listeners.map((({listener:t})=>t)).indexOf(e);t>=0&&s.listeners.splice(t,1)}return e&&0!==s.listeners.length||(s.started&&s.subscriber.stop(),this.#$.delete(s.tag)),this}async removeAllListeners(t){if(t){const{tag:e,started:s,subscriber:r}=await this.#rt(t);s&&r.stop(),this.#$.delete(e)}else for(const[e,{started:s,subscriber:r}]of this.#$)s&&r.stop(),this.#$.delete(e);return this}async addListener(t,e){return await this.on(t,e)}async removeListener(t,e){return this.off(t,e)}get destroyed(){return this.#q}destroy(){this.removeAllListeners();for(const t of this.#j.keys())this._clearTimeout(t);this.#q=!0}get paused(){return null!=this.#M}set paused(t){!!t!==this.paused&&(this.paused?this.resume():this.pause(!1))}pause(t){if(this.#z=-1,null!=this.#M){if(this.#M==!!t)return;(0,r.vA)(!1,"cannot change pause type; resume first","UNSUPPORTED_OPERATION",{operation:"pause"})}this._forEachSubscriber((e=>e.pause(t))),this.#M=!!t;for(const e of this.#j.values())e.timer&&clearTimeout(e.timer),e.time=Et()-e.time}resume(){if(null!=this.#M){this._forEachSubscriber((t=>t.resume())),this.#M=null;for(const t of this.#j.values()){let e=t.time;e<0&&(e=0),t.time=Et(),setTimeout(t.func,e)}}}}function Pt(t,e){try{const s=Ct(t,e);if(s)return(0,u._v)(s)}catch(s){}return null}function Ct(t,e){if("0x"===t)return null;try{const s=(0,d.WZ)((0,h.ZG)(t,e,e+32)),r=(0,d.WZ)((0,h.ZG)(t,s,s+32));return(0,h.ZG)(t,s+32,s+32+r)}catch(s){}return null}function It(t){const e=(0,d.c4)(t);if(e.length>32)throw new Error("internal; should not happen");const s=new Uint8Array(32);return s.set(e,32-e.length),s}function xt(t){if(t.length%32===0)return t;const e=new Uint8Array(32*Math.ceil(t.length/32));return e.set(t),e}const St=new Uint8Array([]);function Lt(t){const e=[];let s=0;for(let r=0;r<t.length;r++)e.push(St),s+=32;for(let r=0;r<t.length;r++){const n=(0,h.q5)(t[r]);e[r]=It(s),e.push(It(n.length)),e.push(xt(n)),s+=32+32*Math.ceil(n.length/32)}return(0,h.xW)(e)}const Ft="0x0000000000000000000000000000000000000000000000000000000000000000";var Ut=s(10161);class Dt{#C;#nt;#I;#F;#it;#at;constructor(t){this.#C=t,this.#nt=null,this.#I=this.#L.bind(this),this.#F=!1,this.#it=null,this.#at=!1}_subscribe(t){throw new Error("subclasses must override this")}_emitResults(t,e){throw new Error("subclasses must override this")}_recover(t){throw new Error("subclasses must override this")}async#L(t){try{null==this.#nt&&(this.#nt=this._subscribe(this.#C));let t=null;try{t=await this.#nt}catch(e){if(!(0,r.bJ)(e,"UNSUPPORTED_OPERATION")||"eth_newFilter"!==e.operation)throw e}if(null==t)return this.#nt=null,void this.#C._recoverSubscriber(this,this._recover(this.#C));const s=await this.#C.getNetwork();if(this.#it||(this.#it=s),this.#it.chainId!==s.chainId)throw new Error("chaid changed");if(this.#at)return;const n=await this.#C.send("eth_getFilterChanges",[t]);await this._emitResults(this.#C,n)}catch(e){console.log("@TODO",e)}this.#C.once("block",this.#I)}#ot(){const t=this.#nt;t&&(this.#nt=null,t.then((t=>{this.#C.destroyed||this.#C.send("eth_uninstallFilter",[t])})))}start(){this.#F||(this.#F=!0,this.#L(-2))}stop(){this.#F&&(this.#F=!1,this.#at=!0,this.#ot(),this.#C.off("block",this.#I))}pause(t){t&&this.#ot(),this.#C.off("block",this.#I)}resume(){this.start()}}class Bt extends Dt{#lt;constructor(t,e){var s;super(t),this.#lt=(s=e,JSON.parse(JSON.stringify(s)))}_recover(t){return new bt(t,this.#lt)}async _subscribe(t){return await t.send("eth_newFilter",[this.#lt])}async _emitResults(t,e){for(const s of e)t.emit(this.#lt,t._wrapLog(s,t._network))}}class Gt extends Dt{async _subscribe(t){return await t.send("eth_newPendingTransactionFilter",[])}async _emitResults(t,e){for(const s of e)t.emit("pending",s)}}const $t="bigint,boolean,function,number,string,symbol".split(/,/g);function Mt(t){if(null==t||$t.indexOf(typeof t)>=0)return t;if("function"===typeof t.getAddress)return t;if(Array.isArray(t))return t.map(Mt);if("object"===typeof t)return Object.keys(t).reduce(((e,s)=>(e[s]=t[s],e)),{});throw new Error(`should not happen: ${t} (${typeof t})`)}function qt(t){return new Promise((e=>{setTimeout(e,t)}))}function Jt(t){return t?t.toLowerCase():t}function Zt(t){return t&&"number"===typeof t.pollingInterval}const Wt={polling:!1,staticNetwork:null,batchStallTime:10,batchMaxSize:1<<20,batchMaxCount:100,cacheTimeout:250,pollingInterval:4e3};class zt extends Ut.Z{address;constructor(t,e){super(t),e=(0,i.b)(e),(0,c.n)(this,{address:e})}connect(t){(0,r.vA)(!1,"cannot reconnect JsonRpcSigner","UNSUPPORTED_OPERATION",{operation:"signer.connect"})}async getAddress(){return this.address}async populateTransaction(t){return await this.populateCall(t)}async sendUncheckedTransaction(t){const e=Mt(t),s=[];if(e.from){const n=e.from;s.push((async()=>{const s=await(0,a.tG)(n,this.provider);(0,r.MR)(null!=s&&s.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),e.from=s})())}else e.from=this.address;if(null==e.gasLimit&&s.push((async()=>{e.gasLimit=await this.provider.estimateGas({...e,from:this.address})})()),null!=e.to){const t=e.to;s.push((async()=>{e.to=await(0,a.tG)(t,this.provider)})())}s.length&&await Promise.all(s);const n=this.provider.getRpcTransaction(e);return this.provider.send("eth_sendTransaction",[n])}async sendTransaction(t){const e=await this.provider.getBlockNumber(),s=await this.sendUncheckedTransaction(t);return await new Promise(((t,n)=>{const i=[1e3,100];let a=0;const o=async()=>{try{const r=await this.provider.getTransaction(s);if(null!=r)return void t(r.replaceableTransaction(e))}catch(l){if((0,r.bJ)(l,"CANCELLED")||(0,r.bJ)(l,"BAD_DATA")||(0,r.bJ)(l,"NETWORK_ERROR")||(0,r.bJ)(l,"UNSUPPORTED_OPERATION"))return null==l.info&&(l.info={}),l.info.sendTransactionHash=s,void n(l);if((0,r.bJ)(l,"INVALID_ARGUMENT")&&(a++,null==l.info&&(l.info={}),l.info.sendTransactionHash=s,a>10))return void n(l);this.provider.emit("error",(0,r.xz)("failed to fetch transation after sending (will try again)","UNKNOWN_ERROR",{error:l}))}this.provider._setTimeout((()=>{o()}),i.pop()||4e3)};o()}))}async signTransaction(t){const e=Mt(t);if(e.from){const s=await(0,a.tG)(e.from,this.provider);(0,r.MR)(null!=s&&s.toLowerCase()===this.address.toLowerCase(),"from address mismatch","transaction",t),e.from=s}else e.from=this.address;const s=this.provider.getRpcTransaction(e);return await this.provider.send("eth_signTransaction",[s])}async signMessage(t){const e="string"===typeof t?(0,u.YW)(t):t;return await this.provider.send("personal_sign",[(0,h.c$)(e),this.address.toLowerCase()])}async signTypedData(t,e,s){const n=Mt(s),i=await o.z.resolveNames(t,e,n,(async t=>{const e=await(0,a.tG)(t);return(0,r.MR)(null!=e,"TypedData does not support null address","value",t),e}));return await this.provider.send("eth_signTypedData_v4",[this.address.toLowerCase(),JSON.stringify(o.z.getPayload(i.domain,e,i.value))])}async unlock(t){return this.provider.send("personal_unlockAccount",[this.address.toLowerCase(),t,null])}async _legacySignMessage(t){const e="string"===typeof t?(0,u.YW)(t):t;return await this.provider.send("eth_sign",[this.address.toLowerCase(),(0,h.c$)(e)])}}class Ht extends Ot{#K;#ct;#ut;#ht;#dt;#it;#pt;#gt(){if(this.#ht)return;const t=1===this._getOption("batchMaxCount")?0:this._getOption("batchStallTime");this.#ht=setTimeout((()=>{this.#ht=null;const t=this.#ut;for(this.#ut=[];t.length;){const e=[t.shift()];for(;t.length&&e.length!==this.#K.batchMaxCount;){e.push(t.shift());if(JSON.stringify(e.map((t=>t.payload))).length>this.#K.batchMaxSize){t.unshift(e.pop());break}}(async()=>{const t=1===e.length?e[0].payload:e.map((t=>t.payload));this.emit("debug",{action:"sendRpcPayload",payload:t});try{const s=await this._send(t);this.emit("debug",{action:"receiveRpcResult",result:s});for(const{resolve:t,reject:n,payload:i}of e){if(this.destroyed){n((0,r.xz)("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:i.method}));continue}const e=s.filter((t=>t.id===i.id))[0];if(null!=e)"error"in e?n(this.getRpcError(i,e)):t(e.result);else{const t=(0,r.xz)("missing response for request","BAD_DATA",{value:s,info:{payload:i}});this.emit("error",t),n(t)}}}catch(s){this.emit("debug",{action:"receiveRpcError",error:s});for(const{reject:t}of e)t(s)}})()}}),t)}constructor(t,e){super(t,e),this.#ct=1,this.#K=Object.assign({},Wt,e||{}),this.#ut=[],this.#ht=null,this.#it=null,this.#pt=null;{let t=null;const e=new Promise((e=>{t=e}));this.#dt={promise:e,resolve:t}}const s=this._getOption("staticNetwork");"boolean"===typeof s?((0,r.MR)(!s||"any"!==t,"staticNetwork cannot be used on special network 'any'","options",e),s&&null!=t&&(this.#it=lt.from(t))):s&&((0,r.MR)(null==t||s.matches(t),"staticNetwork MUST match network object","options",e),this.#it=s)}_getOption(t){return this.#K[t]}get _network(){return(0,r.vA)(this.#it,"network is not available yet","NETWORK_ERROR"),this.#it}async _perform(t){if("call"===t.method||"estimateGas"===t.method){let e=t.transaction;if(e&&null!=e.type&&(0,d.Ab)(e.type)&&null==e.maxFeePerGas&&null==e.maxPriorityFeePerGas){const s=await this.getFeeData();null==s.maxFeePerGas&&null==s.maxPriorityFeePerGas&&(t=Object.assign({},t,{transaction:Object.assign({},e,{type:void 0})}))}}const e=this.getRpcRequest(t);return null!=e?await this.send(e.method,e.args):super._perform(t)}async _detectNetwork(){const t=this._getOption("staticNetwork");if(t){if(!0!==t)return t;if(this.#it)return this.#it}return this.#pt?await this.#pt:this.ready?(this.#pt=(async()=>{try{const t=lt.from((0,d.Ab)(await this.send("eth_chainId",[])));return this.#pt=null,t}catch(t){throw this.#pt=null,t}})(),await this.#pt):(this.#pt=(async()=>{const t={id:this.#ct++,method:"eth_chainId",params:[],jsonrpc:"2.0"};let e;this.emit("debug",{action:"sendRpcPayload",payload:t});try{e=(await this._send(t))[0],this.#pt=null}catch(s){throw this.#pt=null,this.emit("debug",{action:"receiveRpcError",error:s}),s}if(this.emit("debug",{action:"receiveRpcResult",result:e}),"result"in e)return lt.from((0,d.Ab)(e.result));throw this.getRpcError(t,e)})(),await this.#pt)}_start(){null!=this.#dt&&null!=this.#dt.resolve&&(this.#dt.resolve(),this.#dt=null,(async()=>{for(;null==this.#it&&!this.destroyed;)try{this.#it=await this._detectNetwork()}catch(t){if(this.destroyed)break;console.log("JsonRpcProvider failed to detect network and cannot start up; retry in 1s (perhaps the URL is wrong or the node is not started)"),this.emit("error",(0,r.xz)("failed to bootstrap network detection","NETWORK_ERROR",{event:"initial-network-discovery",info:{error:t}})),await qt(1e3)}this.#gt()})())}async _waitUntilReady(){if(null!=this.#dt)return await this.#dt.promise}_getSubscriber(t){return"pending"===t.type?new Gt(this):"event"===t.type?this._getOption("polling")?new bt(this,t.filter):new Bt(this,t.filter):"orphan"===t.type&&"drop-log"===t.filter.orphan?new Nt("orphan"):super._getSubscriber(t)}get ready(){return null==this.#dt}getRpcTransaction(t){const e={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach((s=>{if(null==t[s])return;let r=s;"gasLimit"===s&&(r="gas"),e[r]=(0,d.nD)((0,d.Ab)(t[s],`tx.${s}`))})),["from","to","data"].forEach((s=>{null!=t[s]&&(e[s]=(0,h.c$)(t[s]))})),t.accessList&&(e.accessList=(0,l.$)(t.accessList)),t.blobVersionedHashes&&(e.blobVersionedHashes=t.blobVersionedHashes.map((t=>t.toLowerCase()))),e}getRpcRequest(t){switch(t.method){case"chainId":return{method:"eth_chainId",args:[]};case"getBlockNumber":return{method:"eth_blockNumber",args:[]};case"getGasPrice":return{method:"eth_gasPrice",args:[]};case"getPriorityFee":return{method:"eth_maxPriorityFeePerGas",args:[]};case"getBalance":return{method:"eth_getBalance",args:[Jt(t.address),t.blockTag]};case"getTransactionCount":return{method:"eth_getTransactionCount",args:[Jt(t.address),t.blockTag]};case"getCode":return{method:"eth_getCode",args:[Jt(t.address),t.blockTag]};case"getStorage":return{method:"eth_getStorageAt",args:[Jt(t.address),"0x"+t.position.toString(16),t.blockTag]};case"broadcastTransaction":return{method:"eth_sendRawTransaction",args:[t.signedTransaction]};case"getBlock":if("blockTag"in t)return{method:"eth_getBlockByNumber",args:[t.blockTag,!!t.includeTransactions]};if("blockHash"in t)return{method:"eth_getBlockByHash",args:[t.blockHash,!!t.includeTransactions]};break;case"getTransaction":return{method:"eth_getTransactionByHash",args:[t.hash]};case"getTransactionReceipt":return{method:"eth_getTransactionReceipt",args:[t.hash]};case"call":return{method:"eth_call",args:[this.getRpcTransaction(t.transaction),t.blockTag]};case"estimateGas":return{method:"eth_estimateGas",args:[this.getRpcTransaction(t.transaction)]};case"getLogs":return t.filter&&null!=t.filter.address&&(Array.isArray(t.filter.address)?t.filter.address=t.filter.address.map(Jt):t.filter.address=Jt(t.filter.address)),{method:"eth_getLogs",args:[t.filter]}}return null}getRpcError(t,e){const{method:s}=t,{error:i}=e;if("eth_estimateGas"===s&&i.message){const e=i.message;if(!e.match(/revert/i)&&e.match(/insufficient funds/i))return(0,r.xz)("insufficient funds","INSUFFICIENT_FUNDS",{transaction:t.params[0],info:{payload:t,error:i}})}if("eth_call"===s||"eth_estimateGas"===s){const e=Vt(i),r=n.y.getBuiltinCallException("eth_call"===s?"call":"estimateGas",t.params[0],e?e.data:null);return r.info={error:i,payload:t},r}const a=JSON.stringify(function(t){const e=[];return Kt(t,e),e}(i));if("string"===typeof i.message&&i.message.match(/user denied|ethers-user-denied/i)){const e={eth_sign:"signMessage",personal_sign:"signMessage",eth_signTypedData_v4:"signTypedData",eth_signTransaction:"signTransaction",eth_sendTransaction:"sendTransaction",eth_requestAccounts:"requestAccess",wallet_requestAccounts:"requestAccess"};return(0,r.xz)("user rejected action","ACTION_REJECTED",{action:e[s]||"unknown",reason:"rejected",info:{payload:t,error:i}})}if("eth_sendRawTransaction"===s||"eth_sendTransaction"===s){const e=t.params[0];if(a.match(/insufficient funds|base fee exceeds gas limit/i))return(0,r.xz)("insufficient funds for intrinsic transaction cost","INSUFFICIENT_FUNDS",{transaction:e,info:{error:i}});if(a.match(/nonce/i)&&a.match(/too low/i))return(0,r.xz)("nonce has already been used","NONCE_EXPIRED",{transaction:e,info:{error:i}});if(a.match(/replacement transaction/i)&&a.match(/underpriced/i))return(0,r.xz)("replacement fee too low","REPLACEMENT_UNDERPRICED",{transaction:e,info:{error:i}});if(a.match(/only replay-protected/i))return(0,r.xz)("legacy pre-eip-155 transactions not supported","UNSUPPORTED_OPERATION",{operation:s,info:{transaction:e,info:{error:i}}})}let o=!!a.match(/the method .* does not exist/i);return o||i&&i.details&&i.details.startsWith("Unauthorized method:")&&(o=!0),o?(0,r.xz)("unsupported operation","UNSUPPORTED_OPERATION",{operation:t.method,info:{error:i,payload:t}}):(0,r.xz)("could not coalesce error","UNKNOWN_ERROR",{error:i,payload:t})}send(t,e){if(this.destroyed)return Promise.reject((0,r.xz)("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t}));const s=this.#ct++,n=new Promise(((r,n)=>{this.#ut.push({resolve:r,reject:n,payload:{method:t,params:e,id:s,jsonrpc:"2.0"}})}));return this.#gt(),n}async getSigner(t){null==t&&(t=0);const e=this.send("eth_accounts",[]);if("number"===typeof t){const s=await e;if(t>=s.length)throw new Error("no such account");return new zt(this,s[t])}const{accounts:s}=await(0,c.k)({network:this.getNetwork(),accounts:e});t=(0,i.b)(t);for(const r of s)if((0,i.b)(r)===t)return new zt(this,t);throw new Error("invalid account")}async listAccounts(){return(await this.send("eth_accounts",[])).map((t=>new zt(this,t)))}destroy(){this.#ht&&(clearTimeout(this.#ht),this.#ht=null);for(const{payload:t,reject:e}of this.#ut)e((0,r.xz)("provider destroyed; cancelled request","UNSUPPORTED_OPERATION",{operation:t.method}));this.#ut=[],super.destroy()}}class jt extends Ht{#ft;constructor(t,e){super(t,e);let s=this._getOption("pollingInterval");null==s&&(s=Wt.pollingInterval),this.#ft=s}_getSubscriber(t){const e=super._getSubscriber(t);return Zt(e)&&(e.pollingInterval=this.#ft),e}get pollingInterval(){return this.#ft}set pollingInterval(t){if(!Number.isInteger(t)||t<0)throw new Error("invalid interval");this.#ft=t,this._forEachSubscriber((t=>{Zt(t)&&(t.pollingInterval=this.#ft)}))}}function Vt(t){if(null==t)return null;if("string"===typeof t.message&&t.message.match(/revert/i)&&(0,h.Lo)(t.data))return{message:t.message,data:t.data};if("object"===typeof t){for(const e in t){const s=Vt(t[e]);if(s)return s}return null}if("string"===typeof t)try{return Vt(JSON.parse(t))}catch(e){}return null}function Kt(t,e){if(null!=t){if("string"===typeof t.message&&e.push(t.message),"object"===typeof t)for(const s in t)Kt(t[s],e);if("string"===typeof t)try{return Kt(JSON.parse(t),e)}catch(s){}}}class Yt extends jt{#v;constructor(t,e,s){const n=Object.assign({},null!=s?s:{},{batchMaxCount:1});(0,r.MR)(t&&t.request,"invalid EIP-1193 provider","ethereum",t),super(e,n),this.#v=async(e,s)=>{const r={method:e,params:s};this.emit("debug",{action:"sendEip1193Request",payload:r});try{const e=await t.request(r);return this.emit("debug",{action:"receiveEip1193Result",result:e}),e}catch(n){const t=new Error(n.message);throw t.code=n.code,t.data=n.data,t.payload=r,this.emit("debug",{action:"receiveEip1193Error",error:t}),t}}}async send(t,e){return await this._start(),await super.send(t,e)}async _send(t){(0,r.MR)(!Array.isArray(t),"EIP-1193 does not support batch request","payload",t);try{const e=await this.#v(t.method,t.params||[]);return[{id:t.id,result:e}]}catch(e){return[{id:t.id,error:{code:e.code,data:e.data,message:e.message}}]}}getRpcError(t,e){switch((e=JSON.parse(JSON.stringify(e))).error.code||-1){case 4001:e.error.message=`ethers-user-denied: ${e.error.message}`;break;case 4200:e.error.message=`ethers-unsupported: ${e.error.message}`}return super.getRpcError(t,e)}async hasSigner(t){null==t&&(t=0);const e=await this.send("eth_accounts",[]);return"number"===typeof t?e.length>t:(t=t.toLowerCase(),0!==e.filter((e=>e.toLowerCase()===t)).length)}async getSigner(t){if(null==t&&(t=0),!await this.hasSigner(t))try{await this.#v("eth_requestAccounts",[])}catch(e){const t=e.payload;throw this.getRpcError(t,{id:t.id,error:e})}return await super.getSigner(t)}}}}]);
//# sourceMappingURL=421.9428558f.chunk.js.map