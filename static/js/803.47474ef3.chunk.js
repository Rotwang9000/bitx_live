"use strict";(globalThis.webpackChunkwinbit32=globalThis.webpackChunkwinbit32||[]).push([[803,400,765],{67803:(e,t,n)=>{n.d(t,{default:()=>m});var i=n(14806),o=n(63970),r=n(42765),s=n(7460),c=n(9400),a=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{a(i.next(e))}catch(t){r(t)}}function c(e){try{a(i.throw(e))}catch(t){r(t)}}function a(e){e.done?o(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(s,c)}a((i=i.apply(e,t||[])).next())}))};class d{constructor({context:e,logType:t}={}){this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new o.k,this.send=(e,t,n,o,s=i.d.Buffer.alloc(0),c=[r.WC.OK],{abortTimeoutMs:d}={})=>a(this,void 0,void 0,(function*(){const a=this.tracer.withUpdatedContext({function:"send"});if(s.length>=256)throw a.trace("data.length exceeded 256 bytes limit",{dataLength:s.length}),new r.PS("data.length exceed 256 bytes limit. Got: "+s.length,"DataLengthTooBig");a.trace("Starting an exchange",{abortTimeoutMs:d});const u=yield this.exchange(i.d.Buffer.concat([i.d.Buffer.from([e,t,n,o]),i.d.Buffer.from([s.length]),s]),{abortTimeoutMs:d});a.trace("Received response from exchange");const l=u.readUInt16BE(u.length-2);if(!c.some((e=>e===l)))throw new r.rZ(l);return u})),this._appAPIlock=null,this.tracer=new s.L(t??"transport",e)}exchange(e,{abortTimeoutMs:t}={}){throw new Error("exchange not implemented")}exchangeBulk(e,t){let n=!1;return a(this,void 0,void 0,(function*(){if(!n)for(const i of e){const e=yield this.exchange(i);if(n)return;const o=e.readUInt16BE(e.length-2);if(o!==r.WC.OK)throw new r.rZ(o);t.next(e)}})).then((()=>!n&&t.complete()),(e=>!n&&t.error(e))),{unsubscribe:()=>{n=!0}}}setScrambleKey(e){}close(){return Promise.resolve()}on(e,t){this._events.on(e,t)}off(e,t){this._events.removeListener(e,t)}emit(e,...t){this._events.emit(e,...t)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(e){this.exchangeTimeout=e}setExchangeUnresponsiveTimeout(e){this.unresponsiveTimeout=e}static create(e=3e3,t){return new Promise(((n,i)=>{let o=!1;const s=this.listen({next:t=>{o=!0,s&&s.unsubscribe(),c&&clearTimeout(c),this.open(t.descriptor,e).then(n,i)},error:e=>{c&&clearTimeout(c),i(e)},complete:()=>{c&&clearTimeout(c),o||i(new r.PS(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),c=t?setTimeout((()=>{s.unsubscribe(),i(new r.PS(this.ErrorMessage_ListenTimeout,"ListenTimeout"))}),t):null}))}exchangeAtomicImpl(e){return a(this,void 0,void 0,(function*(){const t=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl",unresponsiveTimeout:this.unresponsiveTimeout});if(this.exchangeBusyPromise)throw t.trace("Atomic exchange is already busy"),new r.wp("An action was already pending on the Ledger device. Please deny or reconnect.");let n;const i=new Promise((e=>{n=e}));this.exchangeBusyPromise=i;let o=!1;const s=setTimeout((()=>{t.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),o=!0,this.emit("unresponsive")}),this.unresponsiveTimeout);try{const n=yield e();return o&&(t.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),n}finally{t.trace("Finalize, clearing busy guard"),clearTimeout(s),n&&n(),this.exchangeBusyPromise=null}}))}decorateAppAPIMethods(e,t,n){for(const i of t)e[i]=this.decorateAppAPIMethod(i,e[i],e,n)}decorateAppAPIMethod(e,t,n,i){return(...o)=>a(this,void 0,void 0,(function*(){const{_appAPIlock:s}=this;if(s)return Promise.reject(new r.PS("Ledger Device is busy (lock "+s+")","TransportLocked"));try{return this._appAPIlock=e,this.setScrambleKey(i),yield t.apply(n,o)}finally{this._appAPIlock=null}}))}setTraceContext(e){this.tracer=this.tracer.withContext(e)}updateTraceContext(e){this.tracer.updateContext(e)}getTraceContext(){return this.tracer.getContext()}}d.ErrorMessage_ListenTimeout="No Ledger device found (timeout)",d.ErrorMessage_NoDeviceFound="No Ledger device found";function u(e){const t=i.d.Buffer.alloc(2);return t.writeUInt16BE(e,0),t}const l={data:i.d.Buffer.alloc(0),dataLength:0,sequence:0};var h=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{a(i.next(e))}catch(t){r(t)}}function c(e){try{a(i.throw(e))}catch(t){r(t)}}function a(e){e.done?o(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(s,c)}a((i=i.apply(e,t||[])).next())}))};const f=[{vendorId:c.ledgerUSBVendorId}];function p(){return h(this,void 0,void 0,(function*(){return yield navigator.usb.requestDevice({filters:f})}))}function g(){return h(this,void 0,void 0,(function*(){return(yield navigator.usb.getDevices()).filter((e=>e.vendorId===c.ledgerUSBVendorId))}))}var v=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{a(i.next(e))}catch(t){r(t)}}function c(e){try{a(i.throw(e))}catch(t){r(t)}}function a(e){e.done?o(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(s,c)}a((i=i.apply(e,t||[])).next())}))};class m extends d{constructor(e,t){super(),this.channel=Math.floor(65535*Math.random()),this.packetSize=64,this._disconnectEmitted=!1,this._emitDisconnect=e=>{this._disconnectEmitted||(this._disconnectEmitted=!0,this.emit("disconnect",e))},this.device=e,this.interfaceNumber=t,this.deviceModel=(0,c.H)(e.productId)}static request(){return v(this,void 0,void 0,(function*(){const e=yield p();return m.open(e)}))}static openConnected(){return v(this,void 0,void 0,(function*(){const e=yield g();return 0===e.length?null:m.open(e[0])}))}static open(e){return v(this,void 0,void 0,(function*(){yield e.open(),null===e.configuration&&(yield e.selectConfiguration(1)),yield E(e);const t=e.configurations[0].interfaces.find((({alternates:e})=>e.some((e=>255===e.interfaceClass))));if(!t)throw new r.$u("No WebUSB interface found for your Ledger device. Please upgrade firmware or contact techsupport.");const n=t.interfaceNumber;try{yield e.claimInterface(n)}catch(s){throw yield e.close(),new r.$u(s.message)}const i=new m(e,n),o=t=>{e===t.device&&(navigator.usb.removeEventListener("disconnect",o),i._emitDisconnect(new r.DisconnectedDevice))};return navigator.usb.addEventListener("disconnect",o),i}))}close(){return v(this,void 0,void 0,(function*(){yield this.exchangeBusyPromise,yield this.device.releaseInterface(this.interfaceNumber),yield E(this.device),yield this.device.close()}))}exchange(e){return v(this,void 0,void 0,(function*(){return yield this.exchangeAtomicImpl((()=>v(this,void 0,void 0,(function*(){const{channel:t,packetSize:n}=this;(0,s.l)("apdu","=> "+e.toString("hex"));const o=((e,t)=>({makeBlocks(n){let o=i.d.Buffer.concat([u(n.length),n]);const r=t-5,s=Math.ceil(o.length/r);o=i.d.Buffer.concat([o,i.d.Buffer.alloc(s*r-o.length+1).fill(0)]);const c=[];for(let t=0;t<s;t++){const n=i.d.Buffer.alloc(5);n.writeUInt16BE(e,0),n.writeUInt8(5,2),n.writeUInt16BE(t,3);const s=o.slice(t*r,(t+1)*r);c.push(i.d.Buffer.concat([n,s]))}return c},reduceResponse(t,n){let{data:o,dataLength:s,sequence:c}=t||l;if(n.readUInt16BE(0)!==e)throw new r.PS("Invalid channel","InvalidChannel");if(5!==n.readUInt8(2))throw new r.PS("Invalid tag","InvalidTag");if(n.readUInt16BE(3)!==c)throw new r.PS("Invalid sequence","InvalidSequence");t||(s=n.readUInt16BE(5)),c++;const a=n.slice(t?5:7);return o=i.d.Buffer.concat([o,a]),o.length>s&&(o=o.slice(0,s)),{data:o,dataLength:s,sequence:c}},getReducedResult(e){if(e&&e.dataLength===e.data.length)return e.data}}))(t,n),c=o.makeBlocks(e);for(let e=0;e<c.length;e++)yield this.device.transferOut(3,c[e]);let a,d;for(;!(a=o.getReducedResult(d));){const e=yield this.device.transferIn(3,n),t=i.d.Buffer.from(e.data.buffer);d=o.reduceResponse(d,t)}return(0,s.l)("apdu","<= "+a.toString("hex")),a})))).catch((e=>{throw e&&e.message&&e.message.includes("disconnected")?(this._emitDisconnect(e),new r.vs(e.message)):e}))}))}setScrambleKey(){}}function E(e){return v(this,void 0,void 0,(function*(){try{yield e.reset()}catch(t){console.warn(t)}}))}m.isSupported=()=>Promise.resolve(!!navigator&&!!navigator.usb&&"function"==typeof navigator.usb.getDevices),m.list=g,m.listen=e=>{let t=!1;return function(){return h(this,void 0,void 0,(function*(){const e=yield g();return e.length>0?e[0]:p()}))}().then((n=>{if(!t){const t=(0,c.H)(n.productId);e.next({type:"add",descriptor:n,deviceModel:t}),e.complete()}}),(t=>{window.DOMException&&t instanceof window.DOMException&&18===t.code?e.error(new r.um(t.message)):e.error(new r.FB(t.message))})),{unsubscribe:function(){t=!0}}}},63970:(e,t,n)=>{n.d(t,{e:()=>o,k:()=>r});var i=n(14806),o=(0,i.r)();const r=(0,i.g)(o)},7460:(e,t,n)=>{n.d(t,{L:()=>s,l:()=>r});let i=0;const o=[],r=(e,t,n)=>{const o={type:e,id:String(++i),date:new Date};t&&(o.message=t),n&&(o.data=n),c(o)};class s{constructor(e,t){this.type=e,this.context=t}trace(e,t){(({type:e,message:t,data:n,context:o})=>{const r={type:e,id:String(++i),date:new Date};t&&(r.message=t),n&&(r.data=n),o&&(r.context=o),c(r)})({type:this.type,message:e,data:t,context:this.context})}getContext(){return this.context}setContext(e){this.context=e}updateContext(e){this.context=Object.assign(Object.assign({},this.context),e)}getType(){return this.type}setType(e){this.type=e}withType(e){return new s(e,this.context)}withContext(e){return new s(this.type,e)}withUpdatedContext(e){return new s(this.type,Object.assign(Object.assign({},this.context),e))}}function c(e){for(let n=0;n<o.length;n++)try{o[n](e)}catch(t){console.error(t)}}typeof window<"u"&&(window.__ledgerLogsListen=e=>(o.push(e),()=>{const t=o.indexOf(e);-1!==t&&(o[t]=o[o.length-1],o.pop())}))},9400:(e,t,n)=>{n.d(t,{H:()=>d,ledgerUSBVendorId:()=>a});var i,o,r=n(52019);(o=i||(i={})).blue="blue",o.nanoS="nanoS",o.nanoSP="nanoSP",o.nanoX="nanoX",o.stax="stax";const s={[i.blue]:{id:i.blue,productName:"Ledger\xa0Blue",productIdMM:0,legacyUsbProductId:0,usbOnly:!0,memorySize:491520,masks:[822083584,822149120],getBlockSize:e=>4096},[i.nanoS]:{id:i.nanoS,productName:"Ledger\xa0Nano\xa0S",productIdMM:16,legacyUsbProductId:1,usbOnly:!0,memorySize:327680,masks:[823132160],getBlockSize:e=>{var t;return r.s.lt(null!==(t=r.s.coerce(e))&&void 0!==t?t:"","2.0.0")?4096:2048}},[i.nanoSP]:{id:i.nanoSP,productName:"Ledger Nano S Plus",productIdMM:80,legacyUsbProductId:5,usbOnly:!0,memorySize:1569792,masks:[856686592],getBlockSize:e=>32},[i.nanoX]:{id:i.nanoX,productName:"Ledger\xa0Nano\xa0X",productIdMM:64,legacyUsbProductId:4,usbOnly:!1,memorySize:2097152,masks:[855638016],getBlockSize:e=>4096,bluetoothSpec:[{serviceUuid:"13d63400-2c97-0004-0000-4c6564676572",notifyUuid:"13d63400-2c97-0004-0001-4c6564676572",writeUuid:"13d63400-2c97-0004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-0004-0003-4c6564676572"}]},[i.stax]:{id:i.stax,productName:"Ledger\xa0Stax",productIdMM:96,legacyUsbProductId:6,usbOnly:!1,memorySize:1569792,masks:[857735168],getBlockSize:e=>32,bluetoothSpec:[{serviceUuid:"13d63400-2c97-6004-0000-4c6564676572",notifyUuid:"13d63400-2c97-6004-0001-4c6564676572",writeUuid:"13d63400-2c97-6004-0002-4c6564676572",writeCmdUuid:"13d63400-2c97-6004-0003-4c6564676572"}]}};i.blue,i.nanoS,i.nanoSP,i.nanoX,i.stax;const c=Object.values(s),a=11415,d=e=>{const t=c.find((t=>t.legacyUsbProductId===e));if(t)return t;const n=e>>8;return c.find((e=>e.productIdMM===n))},u=[],l={};for(const h in s){const e=s[h],{bluetoothSpec:t}=e;if(t)for(let n=0;n<t.length;n++){const i=t[n];u.push(i.serviceUuid),l[i.serviceUuid]=l[i.serviceUuid.replace(/-/g,"")]=Object.assign({deviceModel:e},i)}}},42765:(e,t,n)=>{n.d(t,{$u:()=>a,DisconnectedDevice:()=>o,FB:()=>c,PS:()=>f,Pc:()=>s,WC:()=>p,el:()=>i,rZ:()=>g,um:()=>u,vs:()=>r,wp:()=>d});const i=e=>{class t extends Error{constructor(n,i,o){if(super(n||e,o),Object.setPrototypeOf(this,t.prototype),this.name=e,i)for(const e in i)this[e]=i[e];if(o&&function(e){return"object"==typeof e}(o)&&"cause"in o&&!("cause"in this)){const e=o.cause;this.cause=e,"stack"in e&&(this.stack=this.stack+"\nCAUSE: "+e.stack)}}}return t};const o=i("DisconnectedDevice"),r=i("DisconnectedDeviceDuringOperation"),s=i("UserRefusedOnDevice"),c=i("TransportOpenUserCancelled"),a=i("TransportInterfaceNotAvailable"),d=i("TransportRaceCondition"),u=i("TransportWebUSBGestureRequired");var l,h;(h=l||(l={})).Unknown="Unknown",h.LocationServicesDisabled="LocationServicesDisabled",h.LocationServicesUnauthorized="LocationServicesUnauthorized",h.BluetoothScanStartFailed="BluetoothScanStartFailed";class f extends Error{constructor(e,t){const n="TransportError";super(e||n),this.name=n,this.message=e,this.stack=new Error(e).stack,this.id=t}}const p={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,CUSTOM_IMAGE_BOOTLOADER:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738};class g extends Error{constructor(e,{canBeMappedToChildError:t=!0}={}){const n=Object.keys(p).find((t=>p[t]===e))||"UNKNOWN_ERROR",i=function(e){switch(e){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=e&&e<=28671)return"Internal error, please report"}(e)||n,o=`Ledger device: ${i} (0x${e.toString(16)})`;if(super(o),this.name="TransportStatusError",this.statusCode=e,this.statusText=n,Object.setPrototypeOf(this,g.prototype),t&&e===p.LOCKED_DEVICE)return new v(o)}}class v extends g{constructor(e){super(p.LOCKED_DEVICE,{canBeMappedToChildError:!1}),e&&(this.message=e),this.name="LockedDeviceError",Object.setPrototypeOf(this,v.prototype)}}}}]);
//# sourceMappingURL=803.47474ef3.chunk.js.map